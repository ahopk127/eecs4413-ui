<html>
    <head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Auction System &ndash; Team Silicon</title>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
        <style>
         .hidden {
             display: none;
         }
        </style>
    </head>
    <body>
        <h1>Auction System &ndash; Team Silicon</h1>
        <p id="loggedin">You are logged in as <span id="username">?</span>.</p>
        <p id="loggedout">You are not logged in.</p>
        <a href="/login" id="login">Login</a>
        <a href="/register" id="sign-up">Sign Up</a>
        <input type="button" value="Logout" id="logout"><br>
        <a href="/auctions">Auctions</a>
        <a href="/auctions/sell">New Auction</a>
    </body>
    <script>
     function setLoggedIn(userId) {
       $.ajax({
         url: `http://localhost:8085/api/users/${userId}`,
         type: 'GET',
         success: function(result) {
           const username = result.username;
           $("#username").text(username);
         },
         error: function(error){
           console.log(error);
         }
       });
     }

     const userId = localStorage.getItem("activeUserId");
     if (userId) {
       document.getElementById("loggedout").classList.add("hidden");
       document.getElementById("login").classList.add("hidden");
       document.getElementById("sign-up").classList.add("hidden");
       setLoggedIn(userId);
     } else {
       document.getElementById("loggedin").classList.add("hidden");
       document.getElementById("logout").classList.add("hidden");
     }

     document.getElementById("logout").addEventListener("click", (e) => {
       localStorage.removeItem("activeUserId");
       location.reload();
     });
    </script>
</html>
